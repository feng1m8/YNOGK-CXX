#include <fenv.h>
#include <math.h>

double ceik(double mc)
{
    if (mc > 1.0)
    {
        feraiseexcept(FE_INVALID);
        return nan("");
    }

    if (mc > 0.59299)
    {
        double t = 2.45694208987494165 * mc - 1.45694208987494165;
        double t2 = t * t;
        return ((3703.75266375099019 + t2 * (2744.8202909757681 + t2 * 36.2381612593459565)) + t * (5462.47093231923466 + t2 * (543.839017382099411 + t2 * 0.393188651542789784))) /
               ((2077.94377067058435 + t2 * (1959.05960044399275 + t2 * 43.5464368440078942)) + t * (3398.0006976775546 + t2 * (472.794455487539279 + t2)));
    }

    if (mc > 0.350756)
    {
        double t = 4.12823963605439369 * mc - 1.44800482178389491;
        double t2 = t * t;
        return ((4264.2820310397463 + t2 * (3214.59187442783167 + t2 * 43.2589626155454993)) + t * (6341.90978213264024 + t2 * (642.790566685354573 + t2 * 0.475223892294445943))) /
               ((2125.06914237062279 + t2 * (2006.0318793351887 + t2 * 44.1848041560412224)) + t * (3479.95663350926514 + t2 * (482.90017258141889 + t2)));
    }

    if (mc > 0.206924)
    {
        double t = 6.95255575949719117 * mc - 1.43865064797819679;
        double t2 = t * t;
        return ((4870.25402224986382 + t2 * (3738.29369283392307 + t2 * 51.3609902253065926)) + t * (7307.18826377416591 + t2 * (754.928587580583704 + t2 * 0.571948962277566451))) /
               ((2172.51745704102287 + t2 * (2056.13612019430497 + t2 * 44.9026847057686146)) + t * (3565.04737778032566 + t2 * (493.9624051175994 + t2)));
    }

    if (mc > 0.121734)
    {
        double t = 11.7384669562155183 * mc - 1.42897053644793990;
        double t2 = t * t;
        return ((5514.8512729127464 + t2 * (4313.60788246750934 + t2 * 60.598720224393536)) + t * (8350.4595896779631 + t2 * (880.27903031894216 + t2 * 0.68504458747933773))) /
               ((2218.41682813309737 + t2 * (2107.97379949034285 + t2 * 45.6911096775045314)) + t * (3650.41829123846319 + t2 * (505.74295207655096 + t2)));
    }

    if (mc > 0.071412)
    {
        double t = 19.8720241643813839 * mc - 1.41910098962680339;
        double t2 = t * t;
        return ((6188.8743957372448 + t2 * (4935.41351498551527 + t2 * 70.981049144472361)) + t * (9459.3331440432847 + t2 * (1018.21910476032105 + t2 * 0.81599895108245948))) /
               ((2260.73112539748448 + t2 * (2159.68721749761492 + t2 * 46.529895505847651)) + t * (3732.66955095581621 + t2 * (517.86964191812384 + t2)));
    }

    if (mc > 0.04177)
    {
        double t = 33.7359152553808785 * mc - 1.40914918021725929;
        double t2 = t * t;
        return ((6879.5170681289562 + t2 * (5594.8381504799829 + t2 * 82.452856129147838)) + t * (10615.0836403687221 + t2 * (1167.26108955935542 + t2 * 0.96592719058503951))) /
               ((2296.88303450660439 + t2 * (2208.74949754945558 + t2 * 47.3844470709989137)) + t * (3807.37745652028212 + t2 * (529.79651353072921 + t2)));
    }

    if (mc > 0.02436)
    {
        double t = 57.4382538770821367 * mc - 1.39919586444572085;
        double t2 = t * t;
        return ((7570.68275387121 + t2 * (6279.266137001489 + t2 * 94.88688383060594)) + t * (11792.9392624454532 + t2 * (1325.0105896622818 + t2 * 1.1353702959440969))) /
               ((2324.04824540459984 + t2 * (2252.22250562615338 + t2 * 48.2089280211559345)) + t * (3869.56755306385732 + t2 * (540.85752251676412 + t2)));
    }

    if (mc > 0.014165)
    {
        double t = 98.0872976949485042 * mc - 1.38940657184894556;
        double t2 = t * t;
        return ((8247.2601660137746 + t2 * (6974.7495213178613 + t2 * 108.098282908839979)) + t * (12967.7060124572914 + t2 * (1488.54008220335966 + t2 * 1.32411616748380686))) /
               ((2340.47337508405427 + t2 * (2287.70677154700516 + t2 * 48.9575432570382154)) + t * (3915.63324533769906 + t2 * (550.45072377717361 + t2)));
    }

    if (mc > 0.008213)
    {
        double t = 168.010752688172043 * mc - 1.37987231182795699;
        double t2 = t * t;
        return ((8894.2961573611293 + t2 * (7666.5611739483371 + t2 * 121.863474964652041)) + t * (14113.7038749808951 + t2 * (1654.60731579994159 + t2 * 1.53112170837206117))) /
               ((2344.88618943372377 + t2 * (2313.28396270968662 + t2 * 49.5906602613891184)) + t * (3942.81065054556536 + t2 * (558.07615380622169 + t2)));
    }

    if (mc > 0.0)
    {
        double t = 1.0 - 121.758188238159016 * mc;
        return -log(mc * 0.0625) * (34813.4518336350547 + t * (235.767716637974271 + t * 0.199792723884069485)) / (69483.5736412906324 + t * (614.265044703187382 + t)) -
               mc * (9382.53386835986099 + t * (51.6478985993381223 + t * 0.00410754154682816898)) / (37327.7262507318317 + t * (408.017247271148538 + t));
    }

    feraiseexcept(FE_INVALID);
    return nan("");
}

double ceib(double mc)
{
    if (mc > 1.0)
    {
        feraiseexcept(FE_INVALID);
        return nan("");
    }

    if (mc > 0.555073)
    {
        double t = 2.24755971204264969 * mc - 1.24755971204264969;
        double t2 = t * t;
        return ((2030.25011505956379 + t2 * (1727.60635612511943 + t2 * 25.071551030042201)) + t * (3223.16236100954529 + t2 * (361.164121995173076 + t2 * 0.280355207707726826))) /
               ((2420.64907902774675 + t2 * (2327.4846488030684 + t2 * 47.9870997057202318)) + t * (4034.28168313496638 + t2 * (549.23422083920396 + t2)));
    }

    if (mc > 0.302367)
    {
        double t = 3.95716761770595079 * mc - 1.19651690106289522;
        double t2 = t * t;
        return ((2209.26925068374373 + t2 * (1981.37862223307242 + t2 * 29.7612810087709299)) + t * (3606.58475322372526 + t2 * (422.693774742063054 + t2 * 0.33462399986118198))) /
               ((2499.57898767250755 + t2 * (2467.63998386656941 + t2 * 50.0198090806651216)) + t * (4236.30953048456334 + t2 * (581.879599221457589 + t2)));
    }

    if (mc > 0.161052)
    {
        double t = 7.07638962601280827 * mc - 1.1396667020486148;
        double t2 = t * t;
        return ((2359.14823394150129 + t2 * (2254.3078545776176 + t2 * 35.2259786264917876)) + t * (3983.28520266051676 + t2 * (492.601686517364701 + t2 * 0.396605124984359783))) /
               ((2563.95563932625156 + t2 * (2633.23323959119935 + t2 * 52.6711647124832948)) + t * (4450.19076667898892 + t2 * (622.983787815718489 + t2)));
    }

    if (mc > 0.083522)
    {
        double t = 12.8982329420869341 * mc - 1.07728621178898491;
        double t2 = t * t;
        return ((2464.65334987833736 + t2 * (2541.68516994216007 + t2 * 41.5832527504007778)) + t * (4333.38639187691528 + t2 * (571.53606797524881 + t2 * 0.465975784547025267))) /
               ((2600.66956117247726 + t2 * (2823.69445052534842 + t2 * 56.13600123001091)) + t * (4661.64381841490914 + t2 * (674.25435972414302 + t2)));
    }

    if (mc > 0.041966)
    {
        double t = 24.0639137549331023 * mc - 1.00986620463952257;
        double t2 = t * t;
        return ((2509.86724450741259 + t2 * (2835.27071287535469 + t2 * 48.9701196718008345)) + t * (4631.12336462339975 + t2 * (659.86172161727281 + t2 * 0.54158304771955794))) /
               ((2594.15983397593723 + t2 * (3034.20118545214106 + t2 * 60.652838995496991)) + t * (4848.17491604384532 + t2 * (737.1514383835685 + t2)));
    }

    if (mc > 0.020313)
    {
        double t = 46.1829769546944996 * mc - 0.938114810880709371;
        double t2 = t * t;
        return ((2480.58307884128017 + t2 * (3122.00900554841322 + t2 * 57.541132641218839)) + t * (4845.57861173250699 + t2 * (757.31633816400643 + t2 * 0.62119950515996627))) /
               ((2528.85218300581396 + t2 * (3253.8615132415746 + t2 * 66.49609315752245)) + t * (4979.31783250484768 + t2 * (812.40556572486862 + t2)));
    }

    if (mc > 0.009408)
    {
        double t = 91.7010545621274645 * mc - 0.862723521320495186;
        double t2 = t * t;
        return ((2365.25385348859592 + t2 * (3381.09304915246175 + t2 * 67.442026950538221)) + t * (4939.53925884558687 + t2 * (862.16657576129841 + t2 * 0.70143698925710129))) /
               ((2390.48737882063755 + t2 * (3462.34808443022907 + t2 * 73.934680452209164)) + t * (5015.4675579215077 + t2 * (898.99542983710459 + t2)));
    }

    if (mc > 0.004136)
    {
        double t = 189.68133535660091 * mc - 0.784522003034901366;
        double t2 = t * t;
        return ((2160.82916040868119 + t2 * (3584.53058926175721 + t2 * 78.769178005879162)) + t * (4877.14832623847052 + t2 * (970.53716686804832 + t2 * 0.7779711043175392))) /
               ((2172.70451405048305 + t2 * (3630.52345460629336 + t2 * 83.17316322263908)) + t * (4916.35263668839769 + t2 * (993.36676027886685 + t2)));
    }

    if (mc > 0.0)
    {
        double t = 1.0 - 106.292517006802721 * mc;
        return mc * log(mc * 0.0625) * (6607.46457640413908 + t * (19.0287633783211078 - t * 0.0062536894693270446)) / (26150.3443630974309 + t * (354.60398127453604 + t)) +
               (26251.567890258487 + t * (168.788023807915689 + t * 0.352150236262724288)) / (26065.7912239203873 + t * (353.916840382280456 + t));
    }

    if (mc == 0.0)
        return 1.0;

    feraiseexcept(FE_INVALID);
    return nan("");
}

double ceid(double mc)
{
    if (mc > 1.0)
    {
        feraiseexcept(FE_INVALID);
        return nan("");
    }

    if (mc > 0.599909)
    {
        double t = 2.49943137936119533 * mc - 1.49943137936119533;
        double t2 = t * t;
        return ((1593.39813781813498 + t2 * (1058.56241259843217 + t2 * 11.7584241242587571)) + t * (2233.25576544961714 + t2 * (195.247394601357872 + t2 * 0.101486443490307517))) /
               ((1685.47865546030468 + t2 * (1604.88100543517015 + t2 * 38.6743012128666717)) + t * (2756.20968383181114 + t2 * (397.504162950935944 + t2)));
    }

    if (mc > 0.35918)
    {
        double t = 4.1540487436079575 * mc - 1.49205122772910617;
        double t2 = t * t;
        return ((1967.01442513777287 + t2 * (1329.30058268219177 + t2 * 15.044780594834276)) + t * (2779.87604145516343 + t2 * (247.475085945854673 + t2 * 0.130547566005491628))) /
               ((1749.70634057327467 + t2 * (1654.40804288486242 + t2 * 39.1895256017535337)) + t * (2853.92630369567765 + t2 * (406.925098588378587 + t2)));
    }

    if (mc > 0.214574)
    {
        double t = 6.91534237860116454 * mc - 1.48385267554596628;
        double t2 = t * t;
        return ((2409.64196912091452 + t2 * (1659.30176823041376 + t2 * 19.1942111405094383)) + t * (3436.40744503228691 + t2 * (312.18646843068879 + t2 * 0.167847673021897479))) /
               ((1824.89205701262525 + t2 * (1715.38574780156913 + t2 * 39.8798253173462218)) + t * (2971.02216287936566 + t2 * (418.92979171531949 + t2)));
    }

    if (mc > 0.127875)
    {
        double t = 11.5341584101316047 * mc - 1.47493050669557896;
        double t2 = t * t;
        return ((2926.81143179637839 + t2 * (2056.45624281065334 + t2 * 24.3811986813439843)) + t * (4214.52119721241319 + t2 * (391.42051438492537 + t2 * 0.215574280659075512))) /
               ((1910.33091918583314 + t2 * (1787.99942542734799 + t2 * 40.7663012893484449)) + t * (3107.04531802441481 + t2 * (433.673494280825971 + t2)));
    }

    if (mc > 0.076007)
    {
        double t = 19.2797100331611013 * mc - 1.46539292049047582;
        double t2 = t * t;
        return ((3520.6361425110296 + t2 * (2526.67111759550923 + t2 * 30.7739877519417978)) + t * (5121.2842239226937 + t2 * (486.926821696342529 + t2 * 0.276315678908126399))) /
               ((2003.81997889501324 + t2 * (1871.05914195570669 + t2 * 41.8489850490387023)) + t * (3259.09205279874214 + t2 * (451.007555352632053 + t2)));
    }

    if (mc > 0.045052)
    {
        double t = 32.3049588111775157 * mc - 1.45540300436116944;
        double t2 = t * t;
        return ((4188.00087087025347 + t2 * (3072.05695847158556 + t2 * 38.5070211470790031)) + t * (6156.0080960857764 + t2 * (599.76666155374012 + t2 * 0.35295592526136368))) /
               ((2101.6011393842469 + t2 * (1961.76794074710108 + t2 * 43.0997999502743622)) + t * (3421.55151253792527 + t2 * (470.407158843118117 + t2)));
    }

    if (mc > 0.026626)
    {
        double t = 54.2711386084880061 * mc - 1.44502333658960165;
        double t2 = t * t;
        return ((4916.74442376570733 + t2 * (3688.12811638360551 + t2 * 47.644714514781135)) + t * (7304.6632479558695 + t2 * (729.75841970840314 + t2 * 0.448422756936257635))) /
               ((2197.49982676612397 + t2 * (2055.19657857622715 + t2 * 44.4576261146308645)) + t * (3584.94502590860852 + t2 * (490.880160668822953 + t2)));
    }

    if (mc > 0.015689)
    {
        double t = 91.4327512114839536 * mc - 1.43448843375697175;
        double t2 = t * t;
        return ((5688.7542903989517 + t2 * (4364.21513060078954 + t2 * 58.159468141567195)) + t * (8542.6096475195826 + t2 * (875.35992968472914 + t2 * 0.56528145509695951))) /
               ((2285.44062680812883 + t2 * (2145.80779422696555 + t2 * 45.8427480379028781)) + t * (3739.30422133833258 + t2 * (511.23253971875808 + t2)));
    }

    if (mc > 0.009216)
    {
        double t = 154.487872701992894 * mc - 1.42376023482156651;
        double t2 = t * t;
        return ((6475.3392225234969 + t2 * (5081.2997108708577 + t2 * 69.910123337464043)) + t * (9829.1138694605662 + t2 * (1033.32687775311981 + t2 * 0.70526087421186325))) /
               ((2357.74885505777295 + t2 * (2226.89527217032394 + t2 * 47.1609071069631012)) + t * (3872.3256515255336 + t2 * (530.03943432061149 + t2)));
    }

    if (mc > 0.0)
    {
        double t = 1.0 - 108.506944444444444 * mc;
        return -log(mc * 0.0625) * (6.2904323649908115e6 + t * (58565.284164780476 + t * (131.176674599188545 + t * 0.0426826410911220304))) / (1.24937550257219890e7 + t * (203580.53400522541 + t * (921.17729845011868 + t))) -
               (27356.109034438753 + t * (107.767403612304371 - t * 0.0827769227048233593)) / (27104.0854889805978 + t * (358.708172147752755 + t));
    }

    feraiseexcept(FE_INVALID);
    return nan("");
}
